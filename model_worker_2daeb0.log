2024-08-23 16:40:12 | INFO | model_worker | args: Namespace(host='0.0.0.0', port=40000, worker_address='http://localhost:40000', controller_address='http://localhost:10000', model_path='microsoft/llava-med-v1.5-mistral-7b', model_base=None, model_name=None, device='cuda', multi_modal=True, limit_model_concurrency=5, stream_interval=1, no_register=False, load_8bit=False, load_4bit=False)
2024-08-23 16:40:12 | WARNING | model_worker | Multimodal mode is automatically detected with model name, please make sure `llava` is included in the model path.
2024-08-23 16:40:12 | INFO | model_worker | Loading the model llava-med-v1.5-mistral-7b on worker 2daeb0 ...
2024-08-23 16:40:12 | ERROR | stderr | /home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
2024-08-23 16:40:12 | ERROR | stderr |   warnings.warn(
2024-08-23 16:40:24 | ERROR | stderr | Downloading shards:   0%|                              | 0/4 [00:00<?, ?it/s]
2024-08-23 16:40:30 | ERROR | stderr | Downloading shards:   0%|                              | 0/4 [00:05<?, ?it/s]
2024-08-23 16:40:30 | ERROR | stderr | 
2024-08-23 16:40:30 | ERROR | stderr | Traceback (most recent call last):
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connectionpool.py", line 775, in urlopen
2024-08-23 16:40:30 | ERROR | stderr |     self._prepare_proxy(conn)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1044, in _prepare_proxy
2024-08-23 16:40:30 | ERROR | stderr |     conn.connect()
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connection.py", line 652, in connect
2024-08-23 16:40:30 | ERROR | stderr |     sock_and_verified = _ssl_wrap_socket_and_match_hostname(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connection.py", line 805, in _ssl_wrap_socket_and_match_hostname
2024-08-23 16:40:30 | ERROR | stderr |     ssl_sock = ssl_wrap_socket(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 465, in ssl_wrap_socket
2024-08-23 16:40:30 | ERROR | stderr |     ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 509, in _ssl_wrap_socket_impl
2024-08-23 16:40:30 | ERROR | stderr |     return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 513, in wrap_socket
2024-08-23 16:40:30 | ERROR | stderr |     return self.sslsocket_class._create(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 1104, in _create
2024-08-23 16:40:30 | ERROR | stderr |     self.do_handshake()
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 1375, in do_handshake
2024-08-23 16:40:30 | ERROR | stderr |     self._sslobj.do_handshake()
2024-08-23 16:40:30 | ERROR | stderr | ConnectionResetError: [Errno 104] Connection reset by peer
2024-08-23 16:40:30 | ERROR | stderr | 
2024-08-23 16:40:30 | ERROR | stderr | During handling of the above exception, another exception occurred:
2024-08-23 16:40:30 | ERROR | stderr | 
2024-08-23 16:40:30 | ERROR | stderr | Traceback (most recent call last):
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
2024-08-23 16:40:30 | ERROR | stderr |     resp = conn.urlopen(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connectionpool.py", line 843, in urlopen
2024-08-23 16:40:30 | ERROR | stderr |     retries = retries.increment(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/retry.py", line 474, in increment
2024-08-23 16:40:30 | ERROR | stderr |     raise reraise(type(error), error, _stacktrace)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/util.py", line 38, in reraise
2024-08-23 16:40:30 | ERROR | stderr |     raise value.with_traceback(tb)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connectionpool.py", line 775, in urlopen
2024-08-23 16:40:30 | ERROR | stderr |     self._prepare_proxy(conn)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1044, in _prepare_proxy
2024-08-23 16:40:30 | ERROR | stderr |     conn.connect()
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connection.py", line 652, in connect
2024-08-23 16:40:30 | ERROR | stderr |     sock_and_verified = _ssl_wrap_socket_and_match_hostname(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/connection.py", line 805, in _ssl_wrap_socket_and_match_hostname
2024-08-23 16:40:30 | ERROR | stderr |     ssl_sock = ssl_wrap_socket(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 465, in ssl_wrap_socket
2024-08-23 16:40:30 | ERROR | stderr |     ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/urllib3/util/ssl_.py", line 509, in _ssl_wrap_socket_impl
2024-08-23 16:40:30 | ERROR | stderr |     return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 513, in wrap_socket
2024-08-23 16:40:30 | ERROR | stderr |     return self.sslsocket_class._create(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 1104, in _create
2024-08-23 16:40:30 | ERROR | stderr |     self.do_handshake()
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/ssl.py", line 1375, in do_handshake
2024-08-23 16:40:30 | ERROR | stderr |     self._sslobj.do_handshake()
2024-08-23 16:40:30 | ERROR | stderr | urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
2024-08-23 16:40:30 | ERROR | stderr | 
2024-08-23 16:40:30 | ERROR | stderr | During handling of the above exception, another exception occurred:
2024-08-23 16:40:30 | ERROR | stderr | 
2024-08-23 16:40:30 | ERROR | stderr | Traceback (most recent call last):
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/runpy.py", line 196, in _run_module_as_main
2024-08-23 16:40:30 | ERROR | stderr |     return _run_code(code, main_globals, None,
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/runpy.py", line 86, in _run_code
2024-08-23 16:40:30 | ERROR | stderr |     exec(code, run_globals)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/llava_med/LLaVA-Med/llava/serve/model_worker.py", line 275, in <module>
2024-08-23 16:40:30 | ERROR | stderr |     worker = ModelWorker(args.controller_address,
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/llava_med/LLaVA-Med/llava/serve/model_worker.py", line 65, in __init__
2024-08-23 16:40:30 | ERROR | stderr |     self.tokenizer, self.model, self.image_processor, self.context_len = load_pretrained_model(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/llava_med/LLaVA-Med/llava/model/builder.py", line 31, in load_pretrained_model
2024-08-23 16:40:30 | ERROR | stderr |     model = LlavaMistralForCausalLM.from_pretrained(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3351, in from_pretrained
2024-08-23 16:40:30 | ERROR | stderr |     resolved_archive_file, sharded_metadata = get_checkpoint_shard_files(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/transformers/utils/hub.py", line 1017, in get_checkpoint_shard_files
2024-08-23 16:40:30 | ERROR | stderr |     cached_filename = cached_file(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/transformers/utils/hub.py", line 389, in cached_file
2024-08-23 16:40:30 | ERROR | stderr |     resolved_file = hf_hub_download(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
2024-08-23 16:40:30 | ERROR | stderr |     return f(*args, **kwargs)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
2024-08-23 16:40:30 | ERROR | stderr |     return fn(*args, **kwargs)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1240, in hf_hub_download
2024-08-23 16:40:30 | ERROR | stderr |     return _hf_hub_download_to_cache_dir(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1389, in _hf_hub_download_to_cache_dir
2024-08-23 16:40:30 | ERROR | stderr |     _download_to_tmp_and_move(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1915, in _download_to_tmp_and_move
2024-08-23 16:40:30 | ERROR | stderr |     http_get(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 463, in http_get
2024-08-23 16:40:30 | ERROR | stderr |     r = _request_wrapper(
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 399, in _request_wrapper
2024-08-23 16:40:30 | ERROR | stderr |     response = get_session().request(method=method, url=url, **params)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
2024-08-23 16:40:30 | ERROR | stderr |     resp = self.send(prep, **send_kwargs)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
2024-08-23 16:40:30 | ERROR | stderr |     r = adapter.send(request, **kwargs)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 66, in send
2024-08-23 16:40:30 | ERROR | stderr |     return super().send(request, *args, **kwargs)
2024-08-23 16:40:30 | ERROR | stderr |   File "/home/lby/anaconda3/envs/llava-med/lib/python3.10/site-packages/requests/adapters.py", line 682, in send
2024-08-23 16:40:30 | ERROR | stderr |     raise ConnectionError(err, request=request)
2024-08-23 16:40:30 | ERROR | stderr | requests.exceptions.ConnectionError: (ProtocolError('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer')), '(Request ID: 474f5eab-de15-4164-afd6-d0bbd9b302e1)')
